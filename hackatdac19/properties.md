# HACK@DAC 2019

The properties are listed in the table below

| SystemVerilog Assertion   |      Description      | CWE-ID |
|----------|-------------|------|
| assert(~(((j==6) && access\_ctrl\_i[i][7][priv\_lvl\_i])) draft                                                                                                                                                                              | Processor access to CLINT grants it access to PLIC regardless of PLIC access configuration | [CWE-1220](https://cwe.mitre.org/data/definitions/1220.html) |
| assert(~(debug\_mode\_q && umode\_i) \|\| (riscv::PRIV\_LVL\_M))                                                                                                                                                                              | Incorrect access control setting leaving debug enabled                                     | [CWE-1244](https://cwe.mitre.org/data/definitions/1244.html) |
| assert( ((csr\_we \|\| csr\_read) && (csr\_addr.address==riscv::CSR\_MEPC)) \|-> csr\_exception\_o.valid == 1'b1)                                                                                                                              | Execute machine level instructions from user mode                                          | [CWE-1262](https://cwe.mitre.org/data/definitions/1262.html) |
| Would this need to be an iflow property?                                                                                                                                                                                                 | AES internal registers are visible externally                                              | CWE-1357                                                     |
| assert(req\_i \|-> !we\_i), WIP \*\*                                                                                                                                                                                                       | Bootrom can be corrupted by user mode applications                                         | [CWE-1326](https://cwe.mitre.org/data/definitions/1326.html) |
| assert(~((csr\_exception\_i.valid && csr\_exception\_i.cause[63] && commit\_instr\_i[0].fu != CSR) \|\| (amo\_valid\_commit\_o))). this is not quite right<br><br>another idea: assert {amo\_valid\_commit\_o \|-> (exception\_o != csr\_exception\_i)} | Receive CSR interrupts when committing atomic instructions                                 | [CWE-1281](https://cwe.mitre.org/data/definitions/1281.html) |
| assert {amo\_valid\_commit\_o \|-> ~commit\_ack\_o[1]}                                                                                                                                                                                        | Commit the second instruction even if the first is atomic instruction                      |                                                              |
| assert {amo\_valid\_commit \|-> (flush\_ctrl\_if && flush\_ctrl\_id && flush\_ctrl\_ex)}                                                                                                                                                         | Pipeline not flushed after committing an atomic instruction                                |                                                              |
| assert {tvm\_o \|-> (csr\_rdata\_o != satp\_q)}                                                                                                                                                                                              | SATP register (read) accessible in Supervisor mode even if TVM is enabled                  |                                                              |
| assert {tvm\_o \|-> (satp\_d != csr\_wdata\_i)                                                                                                                                                                                               | SATP register (write) accessible in Supervisor mode even if TVM is enabled                 |                                                              |
| assert {(priv\_lvl != $past(priv\_lvl)) \|-> (flush\_ctrl\_if && flush\_ctrl\_id && flush\_ctrl\_ex)}                                                                                                                                            | Pipeline not flushed after change in virtual address translation mode                      |                                                              |
| assert {(instret\_q != $past(instret\_q)) \|-> debug\_mode\_q}                                                                                                                                                                               | Instruction retired counters are updated in non-debug mode                                 |                                                              |
| assert {halt\_o \|-> ex\_valid\_i}                                                                                                                                                                                                          | Exception signal is not set at halt                                                        |                                                              |
| assert (out\_valid -> key == 0) \* draft                                                                                                                                                                                                  | AES key stored in memory at bootup and is not cleared before exiting from firmware setup   | CWE-1274                                                     |
| assert(reset \|-> pwdflag == 0) draft \*\*\* !                                                                                                                                                                                           | JTAG password is only 32 bits                                                              |                                                              |
| assert(reset \|-> pwdflag == 0) draft \*\*\* !                                                                                                                                                                                           | JTAG password flag not reset properly                                                      | CWE-1239                                                     |
| assert(pass\_mode \|-> pass\_data == data\_d)                                                                                                                                                                                               | JTAG key is hardcoded                                                                      | CWE-1329                                                     |
