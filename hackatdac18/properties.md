# HACK@DAC 2018

The properties are listed in the table below

| SystemVerilog Assertion   |      Description      | CWE-ID |
|----------|-------------|------|
| assert -name HACKDAC\_p1 {((\`SOC\_CTRL\_END\_ADDR <= \`UDMA\_START\_ADDR) && (\`SOC\_CTRL\_START\_ADDR >= \`UDMA\_END\_ADDR))}                                                                                                                                                                                     | Address range overlap between peripherals SPI Master and SoC.                                       | [CWE-1260](https://cwe.mitre.org/data/definitions/1260.html) or [CWE-1203](https://cwe.mitre.org/data/definitions/1203.html) |
| assert -name HACKDAC\_p2 {(~((soc\_interconnect.TCDM\_data\_gnt\_DEM\_TO\_XBAR) >> 1) && ((soc\_interconnect.TCDM\_data\_add\_DEM\_TO\_XBAR >= 32'h1C00\_0000) && (soc\_interconnect.TCDM\_data\_add\_DEM\_TO\_XBAR <= 32'h1C08\_0000)))}<br>                                                                                 | Addresses for L2 memory is out of the specified range.                                              | [CWE-1203](https://cwe.mitre.org/data/definitions/1203.html)                                                                 |
| assert -name HACKDAC\_p3 {(~((riscv\_core.cs\_registers\_i.priv\_lvl\_n == riscv\_core.cs\_registers\_i.PRIV\_LVL\_M) && riscv\_core.cs\_registers\_i.mstatus\_n.mpp ==riscv\_core.cs\_registers\_i.PRIV\_LVL\_U))}                                                                                                          | Processor assigns privilege level of execution incorrectly from CSR.                                | [CWE-1207](https://cwe.mitre.org/data/definitions/1207.html)                                                                 |
| assert -name HACKDAC\_p4 {~((apb\_gpio.PWDATA == 32'h1234\_5678) && ((apb\_gpio.s\_apb\_addr ==5'b10010) && (apb\_gpio.r\_gpio\_lock==32'h1234\_5678)))}<br>                                                                                                                                                       | Register that controls GPIO lock can be written to with software.                                   | [CWE-1207](https://cwe.mitre.org/data/definitions/1207.html)                                                                 |
| cover -name HACKDAC\_p5 {~((apb\_gpio.HRESETn) \|\| (apb\_gpio.r\_gpio\_lock ==0))}                                                                                                                                                                                                                           | Reset clears the GPIO lock control register.                                                        | [CWE-1206](https://cwe.mitre.org/data/definitions/1206.html)                                                                 |
|                                                                                                                                                                                                                                                                                                          | Incorrect address range for APB allows memory aliasing.                                             | [CWE-1257](https://cwe.mitre.org/data/definitions/1257.html)                                                                 |
| assert -name HACKDAC\_p7 {((axi\_address\_decoder\_AR.outstanding\_trans\_i) && (axi\_address\_decoder\_AR.CS == axi\_address\_decoder\_AR.NS))}                                                                                                                                                                     | AXI address decoder ignores errors.                                                                 | CWE-20                                                                                                                       |
| assert -name HACKDAC\_p8 {((\`GPIO\_END\_ADDR <= \`UDMA\_START\_ADDR) && (\`GPIO\_START\_ADDR >= \`UDMA\_END\_ADDR) && ((\`SOC\_CTRL\_END\_ADDR <= \`UDMA\_START\_ADDR) && (\`SOC\_CTRL\_START\_ADDR >= \`UDMA\_END\_ADDR)) && ((\`SOC\_CTRL\_END\_ADDR <= \`GPIO\_START\_ADDR) && (\`SOC\_CTRL\_START\_ADDR >= \`GPIO\_END\_ADDR)))} | Address range overlap between GPIO, SPI, and SoC control peripherals.                               | [CWE-1260](https://cwe.mitre.org/data/definitions/1260.html) or [CWE-1203](https://cwe.mitre.org/data/definitions/1203.html) |
| assert -name HACKDAC\_p9 {~((adbg\_tap\_top.passchk==1) && ~(adbg\_tap\_top.bitindex==32))}                                                                                                                                                                                                                   | Incorrect password checking logic in debug unit.                                                    | CWE-1221                                                                                                                     |
| assert -name HACKDAC\_p10 {(adbg\_tap\_top.passchk == 1) \|-> (adbg\_tap\_top .bitindex == 32)}                                                                                                                                                                                                               | Advanced debug unit only checks 31 of the 32 bits of the password.                                  | CWE-1298                                                                                                                     |
| assert -name HACKDAC\_p11 {(~( (riscv\_core.debug\_unit\_i.dbg\_halt != 1) && (riscv\_core.debug\_unit\_i.rdata\_sel\_n == riscv\_core.RD\_DBGS)))}<br>                                                                                                                                                              | Able to access debug register when in halt mode.                                                    | CWE-1298                                                                                                                     |
| assert -name HACKDAC\_p12 {(~(adbg\_tap\_top.passchk ==1) && (adbg\_tap\_top.correct <= 31))}                                                                                                                                                                                                                 | Password check for the debug unit does not reset after successful check.                            | 1329                                                                                                                         |
| assert -name HACKDAC\_p13 {(riscv\_controller.id\_stage\_i.controller\_i.ctrl\_fsm\_ns == riscv\_controller.id\_stage\_i.controller\_i.DECODE) \|=> (riscv\_controller.id\_stage\_i.controller\_i.ctrl\_fsm\_ns != riscv\_controller.id\_stage\_i.controller\_i.DECODE)}                                                      | Faulty decoder state machine logic in RISC-V core results in a hang.                                | CWE-1245                                                                                                                     |
|                                                                                                                                                                                                                                                                                                          | Incomplete case statement in ALU can cause unpredictable behavior.                                  | CWE-1245                                                                                                                     |
|                                                                                                                                                                                                                                                                                                          | Faulty logic in the RTC causing inaccurate time calculation for security-critical flows, e.g., DRM. | CWE-1247                                                                                                                     |
| assert -name HACKDAC\_p16 {(adbg\_tap\_top.trstn\_pad\_i) \|\| (adbg\_tap\_top.correct==0)}                                                                                                                                                                                                                     | Reset for the advanced debug unit not operational.                                                  | CWE-1419                                                                                                                     |
|                                                                                                                                                                                                                                                                                                          | Memory-mapped register file allows code injection.                                                  | 1262                                                                                                                         |
|                                                                                                                                                                                                                                                                                                          | Non-functioning cryptography module causes DOS.                                                     | 1240                                                                                                                         |
|                                                                                                                                                                                                                                                                                                          | Insecure hash function in the cryptography module.                                                  | 1240                                                                                                                         |
| assert -name HACKDAC\_p20 {(~(mux\_func.b == mux\_func.aes\_out))}<br>                                                                                                                                                                                                                                       | Cryptographic key for AES stored in unprotected memory.                                             | 1220                                                                                                                         |
| assert -name HACKDAC\_p21 {(~(mux\_func.c == mux\_func.temperature\_out))}                                                                                                                                                                                                                                   | Temperature sensor is muxed with the cryptography modules.                                          | 1240                                                                                                                         |
|                                                                                                                                                                                                                                                                                                          | ROM size is too small preventing execution of security code.                                        | 1220                                                                                                                         |
|                                                                                                                                                                                                                                                                                                          | Disabled the ability to activate the security-enhanced core.                                        | 1220                                                                                                                         |
| assert -name HACKDAC\_p24 {((apb\_gpio.HRESETn == 1) \|-> (apb\_gpio.PENABLE == 0))}<br>                                                                                                                                                                                                                    | GPIO enable always high.                                                                            | CWE-1329                                                                                                                     |
|                                                                                                                                                                                                                                                                                                          | Unprivileged user-space code can write to the privileged CSR.                                       | 1262                                                                                                                         |
|                                                                                                                                                                                                                                                                                                          | Advanced debug unit password is hard-coded and set on reset.                                        | CWE-1329                                                                                                                     |
| assert -name HACKDAC\_p27 {csr\_we\_int \|-> PULP\_SECURE}                                                                                                                                                                                                                                                   | Secure mode is not required to write to interrupt registers.                                        | 1220                                                                                                                         |
| assert -name HACKDAC\_p28 {((jtag\_tap\_top.td\_i == 1 \|\| jtag\_tap\_top.td\_i == 0))}                                                                                                                                                                                                                        | JTAG interface is not password protected.                                                           | 1262                                                                                                                         |
| assert -name HACKDAC\_p29 {rst \|-> aes\_out == 0 && c == 0}                                                                                                                                                                                                                                               | Output of MAC is not erased on reset.                                                               | 325                                                                                                                          |
|                                                                                                                                                                                                                                                                                                          | Supervisor mode signal of a core is floating preventing the use of SMAP.                            | 1271                                                                                                                         |
|                                                                                                                                                                                                                                                                                                          | GPIO is able to read/write to instruction and data cache.                                           | CWE-1220 
