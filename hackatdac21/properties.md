# HACK@DAC 2021

The properties are listed in the table below

| SystemVerilog Assertion   |      Description      | CWE-ID |
|----------|-------------|------|
| assert(~trst\_ni \|-> pass\_check == 1'b0)                                                                                                                                                         | JTAG password flag not reset properly                                                                                                                                                                                           | CWE-1239 |
| assert (state\_q == IDLE && state\_d == WRITE \|-> pass\_check == 1'b1)                                                                                                                             | Able to write using JTAG without password                                                                                                                                                                                       | CWE-1245 |
| not sure.. wouldn't this need a new signal added or some timing element?                                                                                                                         | JTAG not temporarily disabled after several continuous wrong password attempts                                                                                                                                                  | CWE-1191 |
| assert(~(debug\_mode\_q && umode\_i) \|\| (riscv::PRIV\_LVL\_M))                                                                                                                                      | Incorrect access control setting leaving debug enabled                                                                                                                                                                          | CWE-1220 |
| Would this need to be an iflow property?                                                                                                                                                         | AES internal registers are visible externally                                                                                                                                                                                   | CWE-1357 |
| assert(count - 1 == $next(count)) or something \*\* draft                                                                                                                                        | Counter register in AES CTR mode does not increase                                                                                                                                                                              | CWE-1240 |
| assert((csr\_we && csr.addr.address == riscv::CSR\_SIE) -> mie\_d == (mie\_q & ~mideleg\_q) \| (csr\_wdata & mideleg\_q))                                                                               | Access to CSRs from lower privilege level                                                                                                                                                                                       | CWE-1262 |
| assert(top\_level. irq\_i == submodule.irq\_i && top\_level.time\_irq\_i == submodule.time\_irq\_i ) \*\* draft                                                                                          | IRQ source input badly connected                                                                                                                                                                                                | CWE-1276 |
| assert (out\_valid -> key == 0) \* draft                                                                                                                                                          | AES key stored in memory at bootup and is not cleared before exiting from firmware setup                                                                                                                                        | CWE-1274 |
| assert(pass\_mode \|-> pass\_data == data\_d)                                                                                                                                                       | JTAG key is hardcoded                                                                                                                                                                                                           | CWE-1329 |
| assert(pass\_mode \|-> pass\_data == data\_d)                                                                                                                                                       | JTAG key is hardcoded                                                                                                                                                                                                           | CWE-1329 |
| assert~(~(rst\_ni && ~jtag\_unlock && ~rst\_9) \|-> (reglk\_mem == 'h0))                                                                                                                             | Reg locks are disabled by default when reset                                                                                                                                                                                    | CWE-1232 |
| assert (sha256\_ctrl\_reg == IGNORE && ignore\_input\_reg \|-> data == 0)                                                                                                                            | SHA input data not cleared after HASH computation                                                                                                                                                                               | CWE-1239 |
| assert(ct\_valid \|-> ((p\_c[0] == 0) && (p\_c[1] == 0) && (p\_c[2] == 0) && (p\_c[3] == 0))                                                                                                          | AES plain text is left uncleared after the encryption is over in the peripheral registers                                                                                                                                       | CWE-226  |
| assert(~(mem[X] == 0)) \*\* need to update with correct index                                                                                                                                    | One of AES user keys is all zeros (weak key)                                                                                                                                                                                    | CWE-1240 |
| assert ( (rst\_ni && rst\_6) \|\| (acct\_mem[0]==32'h0000\_0000))                                                                                                                                    | At reset, the access control values are set to full access                                                                                                                                                                      | CWE-276  |
| assert(debug\_mode\_i \|-> ((key\_big == 192'b0) && (key\_big2 == 192'b0)))                                                                                                                          | Not disconnecting sensitive data from fuse when in debug mode                                                                                                                                                                   | CWE-1243 |
| assert(debug\_mode\_i \|-> ((key\_big == 192'b0) && (key\_big2 == 192'b0)))                                                                                                                          | not clearing one of the aes keys when entering debug mode                                                                                                                                                                       | CWE-1258 |
| assert(~(rst\_ni&& ~rst\_9) \|-> ~jtag\_unlock)                                                                                                                                                     | JTAG unlock disables the reglocks                                                                                                                                                                                               | CWE-1234 |
| working on                                                                                                                                                                                       | Change in PMP config doesnt abort existing DMA transfer. If PMP changes after the DMA starts, then the store pmp checking might use the updated reg values and not the original ones                                            | CWE-1298 |
| assert(dma\_ctrl\_reg == CTRL\_ABORT && !done \|=> dma\_ctrl\_reg != CTRL\_ABORT) // transition out of this state basicaly                                                                             | if abort is issued when there is no active command running in dma, the dma gets stuck in a unknown state                                                                                                                        | CWE-1245 |
| assert((encrypt\_decrypt\_i == 1) \|-> msg\_in != msg\_out) ?? if we are encrypting, message should not be equal to encrypted message                                                                | RSA can generate 1 as encryption key, which will make the plain-text and crypt-text the same.                                                                                                                                   | CWE-1240 |
| assert((reglock == 0) \|-> ~rst\_ni) \* needs to be refined                                                                                                                                       | Reset registerlock, unlocking all registers: The reset\_controller can send extra reset signals to peripherals. This give a chance to reset the registerlock, and make the private data of all other peripherals to be readable. | CWE-1199 |
| assert( (en && we && address[7:3] == 2) \|-> reglk\_mem[2] != 0) i dont know if this actually makes sense                                                                                         | Some of the register lock registers are not locked by register locks                                                                                                                                                            | CWE-1233 |
| assert( (en && we && address[7:3] == 10) \|-> acct\_mem[10] != 0) . this might not work because the reset sets everything to be 32'hfff in this module.                                           | Some of the access control registers are not locked by register locks                                                                                                                                                           | CWE-1233 |
| assert ( (en && we && address[7:3] == 1 && reglk\_ctrl[5] ) \|-> fuse\_req\_o != wdata // don't write if the lock is set... how do we know if index is 5, just sort of matching from other modules. | Some of the PKT registers are not locked by register locks                                                                                                                                                                      | CWE-1233 |
| assert (mem\_size == JTAG\_OFFSET) // should it be this, or just JTAG\_OFFSET == 100? i would've never figured this out without the CWE                                                             | Incorrect indices used to get the jtag\_hash\_o, ikey\_hash\_o, and okey\_hash\_o values from FUSE mem                                                                                                                                | CWE-1221 |
| assert ((dmi\_req\_ready && state\_q == Write) \|=> (state\_q == WatiWriteValid)).                                                                                                                   | Unreachable state WaitWriteValid in JTAG                                                                                                                                                                                        | CWE-1245 |
| assert ((exponent\_reg != 'd0) \|=> (result\_reg != $prev(result\_reg)) // the idea here is taht result\_reg should always be getting a new value, but this might not be right.                      | Power side channel on binary modular exponentiation module                                                                                                                                                                      | CWE-1300 |
| assert ((exponent\_reg != 'd0) \|=> (result\_reg != $prev(result\_reg)) // the idea here is taht result\_reg should always be getting a new value, but this might not be right.                      | Power side channel in the RSA core can leak private exponent to a physical attacker. Leaking private exponent leads to full private key recovery.                                                                               | CWE-1300 |
| assert(~(rst\_ni && ~rst\_13) \|-> (msg\_out == 0))                                                                                                                                                 | Output message on RSA is not cleared after a soft reset. This can leave decrypted data available in a memory mapped area.                                                                                                       | CWE-226  |
| assert (ariane\_boot\_sel\_i \|-> rom\_rdata\_patch)                                                                                                                                                  | Rom module is hardcoded                                                                                                                                                                                                         | CWE-1310 |
| assert (~rst\_n \|-> regX == 0) where regX is one of the relevant registers                                                                                                                       | Some registers of HMAC are not reset                                                                                                                                                                                            | CWE-1239 |
| assert(~(en\_acct && acct\_ctrl\_i) \|\| en)) \*\* WIP need to look at module                                                                                                                       | CLINT registers are not protected by access control                                                                                                                                                                             | CWE-1317 |
